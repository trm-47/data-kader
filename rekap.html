<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Review Data Kader - PDI Perjuangan</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-red: #D71920;
            --dark-slate: #1e293b;
            --soft-slate: #64748b;
            --glass: rgba(255, 255, 255, 0.95);
        }

        body {
            background: #f8fafc;
            font-family: 'Plus Jakarta Sans', sans-serif;
            color: var(--dark-slate);
        }

        /* Container & Slider */
        .slider-wrapper {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            gap: 20px;
            padding: 20px 10px 40px;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .slider-wrapper::-webkit-scrollbar { display: none; }

        /* Card Luxury Style */
        .rekap-card {
            min-width: 90%;
            scroll-snap-align: center;
            background: var(--glass);
            padding: 28px;
            border-radius: 32px;
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.8);
            max-height: 70vh;
            overflow-y: auto;
            position: relative;
            backdrop-filter: blur(10px);
        }

        .section-title {
            color: var(--primary-red);
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 12px;
        }

        .edit-link {
            font-size: 11px;
            background: #fef2f2;
            color: var(--primary-red);
            padding: 6px 14px;
            border-radius: 100px;
            text-decoration: none;
            font-weight: 700;
            border: 1px solid #fee2e2;
        }

        /* Grid Premium */
        .rekap-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .rekap-item-full { grid-column: span 2; }

        .rekap-item-premium {
            background: #ffffff;
            padding: 12px 16px;
            border-radius: 16px;
            border: 1px solid #f1f5f9;
        }

        .rekap-label {
            font-size: 9px;
            color: var(--soft-slate);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .rekap-value {
            font-size: 13px;
            font-weight: 700;
            color: var(--dark-slate);
            word-break: break-word;
        }

        /* List Items (Pendidikan/Jabatan) */
        .data-box-premium {
            background: white;
            padding: 16px;
            border-radius: 18px;
            margin-bottom: 12px;
            border-left: 5px solid var(--primary-red);
            box-shadow: 0 4px 12px rgba(0,0,0,0.03);
        }

        /* Logo Watermark Background */
        .rekap-card::after {
            content: "";
            position: absolute;
            top: 20px;
            right: 20px;
            width: 80px;
            height: 80px;
            background: url('https://i.ibb.co.com/N2K0XRMW/logo-pdi.png') no-repeat;
            background-size: contain;
            opacity: 0.03;
            pointer-events: none;
        }

        /* Final Buttons */
        .btn-final {
            background: linear-gradient(135deg, #D71920 0%, #991b1b 100%);
            color: white;
            width: 100%;
            padding: 18px;
            border-radius: 20px;
            border: none;
            font-weight: 800;
            font-size: 16px;
            box-shadow: 0 10px 20px rgba(215, 25, 32, 0.3);
            cursor: pointer;
            transition: 0.3s;
        }

        .btn-final:active { transform: scale(0.98); }

        .nav-indicator {
            text-align: center;
            font-size: 12px;
            color: var(--soft-slate);
            margin: 10px 0;
            font-weight: 600;
        }
    </style>
</head>
<body>

<div class="container" style="padding-top: 20px;">
    <div class="header-form" style="text-align: center; margin-bottom: 10px;">
        <img src="https://i.ibb.co.com/N2K0XRMW/logo-pdi.png" alt="Logo" style="width: 50px; margin-bottom: 10px;">
        <h2 style="font-weight: 800; letter-spacing: -0.5px;">Final Review</h2>
        <p style="color: var(--soft-slate); font-size: 13px;">Geser kartu untuk cek akurasi data</p>
    </div>

    <div class="slider-wrapper" id="rekapSlider">
        <div class="rekap-card">
            <div class="section-title">
                <span>Profil Kader</span>
                <a href="step1.html" class="edit-link">EDIT</a>
            </div>
            <div id="fotoPreviewRekap" style="text-align: center; margin-bottom: 20px;"></div>
            <div id="rekapPribadi" class="rekap-grid"></div>
        </div>

        <div class="rekap-card">
            <div class="section-title">
                <span>Pendidikan</span>
                <a href="step2.html" class="edit-link">EDIT</a>
            </div>
            <div id="rekapFormal"></div>
        </div>

        <div class="rekap-card">
            <div class="section-title">
                <span>Kaderisasi</span>
                <a href="step3.html" class="edit-link">EDIT</a>
            </div>
            <div id="rekapKader"></div>
        </div>

        <div class="rekap-card">
            <div class="section-title">
                <span>Jabatan & Kerja</span>
                <a href="step4.html" class="edit-link">EDIT</a>
            </div>
            <div id="rekapJabatanPartai"></div>
            <div id="rekapPekerjaan" style="margin-top: 20px;"></div>
        </div>

        <div class="rekap-card">
            <div class="section-title">
                <span>Skill & Medsos</span>
                <a href="step6.html" class="edit-link">EDIT</a>
            </div>
            <div id="rekapOrganisasi"></div>
            <div id="rekapLainnya"></div>
        </div>
    </div>

    <div class="nav-indicator">
        <span id="cardCounter">Kartu 1 dari 5</span>
    </div>

    <div style="padding: 0 20px 40px;">
        <button onclick="submitSeluruhData()" class="btn-final">KIRIM DATA SEKARANG</button>
        <button onclick="window.history.back()" style="width:100%; background:none; border:none; color:var(--soft-slate); margin-top:15px; font-weight:700; font-size:13px;">Kembali ke sebelumnya</button>
    </div>
</div>

<script src="script.js"></script>
<script>
    window.addEventListener('load', () => {
        loadRekapitulasi();
        
        // Update Counter saat geser
        const slider = document.getElementById('rekapSlider');
        slider.addEventListener('scroll', () => {
            const index = Math.round(slider.scrollLeft / slider.offsetWidth) + 1;
            document.getElementById('cardCounter').innerText = `Kartu ${index} dari 5`;
        });
    });

    function loadRekapitulasi() {
        const data = JSON.parse(localStorage.getItem('kaderData')) || {};
        
        // 1. Foto
        if (data.foto) {
            document.getElementById('fotoPreviewRekap').innerHTML = `
                <div style="position:relative; display:inline-block;">
                    <img src="${data.foto}" style="width:120px; height:120px; border-radius:30px; object-fit:cover; border:5px solid white; box-shadow:0 15px 30px rgba(0,0,0,0.1);">
                    <div style="position:absolute; bottom:-10px; right:-10px; background:var(--primary-red); color:white; padding:5px 12px; border-radius:10px; font-size:10px; font-weight:800;">FOTO KADER</div>
                </div>`;
        }

        // 2. Data Pribadi
        const fields = [
            {l: 'Nama Lengkap', v: data.nama_lengkap, f: true},
            {l: 'NIK', v: data.nik},
            {l: 'KTA', v: data.no_kta},
            {l: 'TTL', v: `${data.tempat_lahir}, ${data.tanggal_lahir}`},
            {l: 'Kontak', v: data.kontak},
            {l: 'Gender', v: data.jenis_kelamin},
            {l: 'Alamat', v: `${data.alamat}, RT ${data.rt}/RW ${data.rw}`, f: true},
            {l: 'Wilayah', v: `${data.kelurahan}, ${data.kecamatan}, ${data.kab_kota}`, f: true}
        ];
        
        document.getElementById('rekapPribadi').innerHTML = fields.map(item => `
            <div class="rekap-item-premium ${item.f ? 'rekap-item-full' : ''}">
                <div class="rekap-label">${item.l}</div>
                <div class="rekap-value">${item.v || '-'}</div>
            </div>
        `).join('');

        // 3. Pendidikan
        document.getElementById('rekapFormal').innerHTML = (data.riwayat_pendidikan || []).map(p => `
            <div class="data-box-premium">
                <div class="rekap-label">${p.jenjang}</div>
                <div class="rekap-value" style="font-size:15px;">${p.nama}</div>
                <div style="font-size:11px; color:var(--soft-slate); margin-top:4px;">Lulus Tahun ${p.tahun} | ${p.kota || ''}</div>
            </div>
        `).join('') || '<p style="text-align:center; color:#94a3b8; font-size:12px;">Data Kosong</p>';

        // 4. Kaderisasi
        document.getElementById('rekapKader').innerHTML = (data.riwayat_kader || []).map(k => `
            <div class="data-box-premium" style="border-left-color: #1e293b;">
                <div class="rekap-label">Tingkat ${k.jenis}</div>
                <div class="rekap-value">${k.penyelenggara}</div>
                <div style="font-size:11px; color:var(--soft-slate);">${k.tahun}</div>
            </div>
        `).join('') || '<p style="text-align:center; color:#94a3b8; font-size:12px;">Data Kosong</p>';

        // 5. Jabatan & Kerja
        const jPartai = (data.riwayat_jabatan_partai || []).map(j => `
            <div class="data-box-premium">
                <div class="rekap-label">${j.tingkatan}</div>
                <div class="rekap-value">${j.jabatan}</div>
                <div style="font-size:11px; color:var(--soft-slate);">Periode: ${j.periode}</div>
            </div>
        `).join('');
        
        const jKerja = (data.riwayat_pekerjaan || []).map(p => `
            <div class="data-box-premium" style="border-left-color: #64748b;">
                <div class="rekap-label">Pekerjaan Profesional</div>
                <div class="rekap-value">${p.perusahaan}</div>
                <div style="font-size:11px; color:var(--soft-slate);">${p.jabatan}</div>
            </div>
        `).join('');
        
        document.getElementById('rekapJabatanPartai').innerHTML = jPartai || '<p style="text-align:center; color:#94a3b8; font-size:12px;">No Party Position</p>';
        document.getElementById('rekapPekerjaan').innerHTML = jKerja;

        // 6. Medsos & Skill
        const ms = data.media_sosial || {};
        const icons = {
            ig: "https://cdn-icons-png.flaticon.com/512/174/174855.png",
            fb: "https://cdn-icons-png.flaticon.com/512/124/124010.png",
            tt: "https://cdn-icons-png.flaticon.com/512/3046/3046121.png"
        };

        document.getElementById('rekapLainnya').innerHTML = `
            <div class="rekap-grid" style="margin-top:20px;">
                <div class="rekap-item-premium"><div class="rekap-label">Bahasa</div><div class="rekap-value">${data.kompetensi_bahasa || '-'}</div></div>
                <div class="rekap-item-premium"><div class="rekap-label">Komputer</div><div class="rekap-value">${data.kemampuan_komputer || '-'}</div></div>
                <div class="rekap-item-full rekap-item-premium">
                    <div class="rekap-label" style="margin-bottom:12px;">E-Identity / Social Media</div>
                    <div style="display:flex; gap:15px; flex-wrap:wrap;">
                        <div style="display:flex; align-items:center; gap:6px; font-size:12px; font-weight:700;">
                            <img src="${icons.ig}" width="16"> ${ms.instagram || '-'}
                        </div>
                        <div style="display:flex; align-items:center; gap:6px; font-size:12px; font-weight:700;">
                            <img src="${icons.tt}" width="16"> ${ms.tiktok || '-'}
                        </div>
                        <div style="display:flex; align-items:center; gap:6px; font-size:12px; font-weight:700;">
                            <img src="${icons.fb}" width="16"> ${ms.facebook || '-'}
                        </div>
                    </div>
                </div>
            </div>`;
    }
</script>
</body>
</html>
