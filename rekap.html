<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Review Data Kader - Premium</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --primary-red: #b91c1c;
            --dark-bg: #1e293b;
            --lux-gold: #fbbf24;
            --radius: 15px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f1f5f9;
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        /* Container Slider Utama */
        .slider-container {
            width: 100%;
            max-width: 500px;
            margin: auto;
            overflow: hidden;
            position: relative;
            min-height: 100vh;
            background: #fff;
        }

        .slider-wrapper {
            display: flex;
            transition: transform 0.4s cubic-bezier(0.25, 1, 0.5, 1);
            height: 100%;
        }

        /* Slide Individu */
        .slide {
            min-width: 100%;
            box-sizing: border-box;
            padding: 25px 20px 100px 20px; /* Space bawah untuk nav */
        }

        /* Card Premium */
        .premium-card {
            background: white;
            border-radius: var(--radius);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            padding: 20px;
            border-top: 5px solid var(--primary-red);
        }

        .title-section {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            color: var(--primary-red);
            font-weight: 800;
            text-transform: uppercase;
            font-size: 1.1rem;
            border-bottom: 2px solid #fee2e2;
            padding-bottom: 10px;
        }

        /* Foto Preview */
        .photo-wrapper {
            text-align: center;
            margin-bottom: 20px;
        }
        #fotoPreviewRekap img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary-red);
            box-shadow: 0 5px 15px rgba(185, 28, 28, 0.3);
        }

        /* Item Data */
        .rekap-item {
            margin-bottom: 15px;
        }
        .rekap-label {
            font-size: 11px;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }
        .rekap-value {
            font-size: 14px;
            color: #1e293b;
            font-weight: 600;
            line-height: 1.4;
        }

        /* Box List (Jabatan/Pendidikan/Tugas) */
        .data-box {
            background: #f8fafc;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 4px solid var(--primary-red);
        }
        .data-box b { color: var(--primary-red); font-size: 13px; }
        .data-box p { margin: 5px 0 0 0; font-size: 12px; color: #475569; }

        /* Navigasi Bawah */
        .nav-bottom {
            position: fixed;
            bottom: 0;
            width: 100%;
            max-width: 500px;
            background: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 20px;
            box-shadow: 0 -5px 20px rgba(0,0,0,0.05);
            box-sizing: border-box;
            z-index: 100;
        }

        .btn-nav {
            background: #e2e8f0;
            border: none;
            padding: 12px 18px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            color: #475569;
        }

        .btn-submit {
            background: var(--primary-red);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            font-weight: 800;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(185, 28, 28, 0.3);
        }

        .indicator {
            display: flex;
            gap: 5px;
        }
        .dot {
            width: 8px;
            height: 8px;
            background: #cbd5e1;
            border-radius: 50%;
            transition: 0.3s;
        }
        .dot.active {
            background: var(--primary-red);
            width: 20px;
            border-radius: 10px;
        }
    </style>
</head>
<body>

<div class="slider-container">
    <div class="slider-wrapper" id="sliderWrapper">
        
        <div class="slide">
            <div class="premium-card">
                <div class="photo-wrapper" id="fotoPreviewRekap"></div>
                <div class="title-section"><i class="fas fa-user-tie"></i> Profil Pribadi</div>
                <div id="rekapIdentitas"></div>
            </div>
        </div>

        <div class="slide">
            <div class="premium-card">
                <div class="title-section"><i class="fas fa-sitemap"></i> Jabatan Partai</div>
                <div id="rekapJabatan"></div>
                
                <div class="title-section" style="margin-top:20px;"><i class="fas fa-tasks"></i> Penugasan</div>
                <div id="rekapPenugasan"></div>
            </div>
        </div>

        <div class="slide">
            <div class="premium-card">
                <div class="title-section"><i class="fas fa-graduation-cap"></i> Pendidikan & Organisasi</div>
                <div id="rekapEdukasi"></div>
                
                <div class="title-section" style="margin-top:20px;"><i class="fas fa-share-nodes"></i> Medsos & Skill</div>
                <div id="rekapMedsos"></div>
            </div>
        </div>

    </div>

    <div class="nav-bottom">
        <button class="btn-nav" onclick="moveSlide(-1)"><i class="fas fa-chevron-left"></i></button>
        <div class="indicator" id="dots">
            <div class="dot active"></div>
            <div class="dot"></div>
            <div class="dot"></div>
        </div>
        <button class="btn-nav" onclick="moveSlide(1)"><i class="fas fa-chevron-right"></i></button>
        <button class="btn-submit" id="btnSubmit" style="display:none;" onclick="submitSeluruhData()">KIRIM</button>
    </div>
</div>

<script>
/* ==========================================
    LOGIKA DATA
   ========================================== */
function loadRekap() {
    const data = JSON.parse(localStorage.getItem('kaderData')) || {};
    
    // 1. Foto
    if (data.foto) {
        document.getElementById('fotoPreviewRekap').innerHTML = `<img src="${data.foto}">`;
    }

    // 2. Identitas
    document.getElementById('rekapIdentitas').innerHTML = `
        <div class="rekap-item"><div class="rekap-label">Nama Lengkap</div><div class="rekap-value">${data.nama_lengkap || '-'}</div></div>
        <div class="rekap-item"><div class="rekap-label">NIK</div><div class="rekap-value">${data.nik || '-'}</div></div>
        <div class="rekap-item"><div class="rekap-label">KTA</div><div class="rekap-value">${data.no_kta || '-'}</div></div>
        <div class="rekap-item"><div class="rekap-label">Kontak</div><div class="rekap-value">${data.kontak || '-'}</div></div>
        <div class="rekap-item"><div class="rekap-label">Alamat</div><div class="rekap-value">${data.alamat || '-'}, RT${data.rt}/RW${data.rw}, ${data.kelurahan}, ${data.kecamatan}, ${data.kab_kota}</div></div>
    `;

    // 3. Jabatan Partai
    const jBtn = data.riwayat_jabatan_partai || [];
    document.getElementById('rekapJabatan').innerHTML = jBtn.length ? jBtn.map(j => `
        <div class="data-box">
            <b>${j.jabatan} ${j.bidang ? '- ' + j.bidang : ''}</b>
            <p>${j.tingkatan.toUpperCase()} | üìç ${j.lokasi}</p>
            <p style="font-size:10px;">Periode: ${j.periode}</p>
        </div>
    `).join('') : '<p>Tidak ada riwayat jabatan.</p>';

    // 4. Penugasan
    const pTgs = data.riwayat_penugasan_partai || [];
    document.getElementById('rekapPenugasan').innerHTML = pTgs.length ? pTgs.map(t => `
        <div class="data-box" style="border-left-color: #475569;">
            <b>${t.jenis}: ${t.jabatan}</b>
            <p>${t.lembaga ? t.lembaga + ' | ' : ''}üìç ${t.lokasi}</p>
        </div>
    `).join('') : '<p>Tidak ada riwayat penugasan.</p>';

    // 5. Edukasi
    const pnd = data.riwayat_pendidikan || [];
    document.getElementById('rekapEdukasi').innerHTML = pnd.map(e => `
        <div class="rekap-item">
            <div class="rekap-label">${e.jenjang} - ${e.nama}</div>
            <div class="rekap-value" style="font-size:12px;">${e.info || ''} (Lulus: ${e.tahun})</div>
        </div>
    `).join('');

    // 6. Medsos & Skill
    const m = data.media_sosial || {};
    document.getElementById('rekapMedsos').innerHTML = `
        <div class="rekap-item"><div class="rekap-label">Bahasa</div><div class="rekap-value">${data.kompetensi_bahasa || '-'}</div></div>
        <div class="rekap-item"><div class="rekap-label">Skill Komputer</div><div class="rekap-value">${data.kemampuan_komputer || '-'}</div></div>
        <div style="display:flex; gap:10px; margin-top:10px;">
            ${m.instagram ? '<span><i class="fab fa-instagram"></i></span>' : ''}
            ${m.tiktok ? '<span><i class="fab fa-tiktok"></i></span>' : ''}
            ${m.facebook ? '<span><i class="fab fa-facebook"></i></span>' : ''}
        </div>
    `;
}

/* ==========================================
    LOGIKA SLIDER
   ========================================== */
let currentIdx = 0;
const wrapper = document.getElementById('sliderWrapper');
const dots = document.querySelectorAll('.dot');
const btnSubmit = document.getElementById('btnSubmit');

function moveSlide(dir) {
    currentIdx += dir;
    if (currentIdx < 0) currentIdx = 0;
    if (currentIdx > 2) currentIdx = 2;

    wrapper.style.transform = `translateX(-${currentIdx * 100}%)`;
    
    // Update dots
    dots.forEach((dot, i) => dot.classList.toggle('active', i === currentIdx));
    
    // Tampilkan tombol kirim hanya di slide terakhir
    btnSubmit.style.display = (currentIdx === 2) ? 'block' : 'none';
}

/* ==========================================
    KIRIM DATA
   ========================================== */
async function submitSeluruhData() {
    const data = JSON.parse(localStorage.getItem('kaderData'));
    const btn = document.getElementById('btnSubmit');
    if(!confirm("Kirim data sekarang?")) return;

    btn.disabled = true;
    btn.innerHTML = "LOADING...";

    try {
        await fetch('URL_GAS_ANDA', {
            method: 'POST',
            mode: 'no-cors',
            body: JSON.stringify(data)
        });
        alert("MERDEKA! Data Berhasil Terkirim.");
        localStorage.removeItem('kaderData');
        window.location.href = 'finish.html';
    } catch (e) {
        alert("Gagal koneksi!");
        btn.disabled = false;
        btn.innerHTML = "KIRIM";
    }
}

// Jalankan saat load
window.onload = loadRekap;
</script>

</body>
</html>
