<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Review Data Kader - PDI Perjuangan</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-red: #D71920;
            --dark-slate: #1e293b;
            --soft-slate: #64748b;
            --glass: rgba(255, 255, 255, 0.95);
        }

        body {
            background: #f8fafc;
            font-family: 'Plus Jakarta Sans', sans-serif;
            color: var(--dark-slate);
        }

        /* Container & Slider */
        .slider-wrapper {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            gap: 20px;
            padding: 20px 10px 40px;
            scrollbar-width: none;
            -ms-overflow-style: none;
            user-select: none;
            -webkit-user-drag: none;
            scroll-behavior: smooth;
        }
        .slider-wrapper::-webkit-scrollbar { display: none; }

        .rekap-card img {
    pointer-events: none; /* Supaya gambar foto tidak ikut ketarik mouse */
}

        /* Card Luxury Style */
        .rekap-card {
            min-width: 90%;
            scroll-snap-align: center;
            background: var(--glass);
            padding: 28px;
            border-radius: 32px;
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.08);
            border: 1px solid rgba(255,255,255,0.8);
            max-height: 70vh;
            overflow-y: auto;
            position: relative;
            backdrop-filter: blur(10px);
        }

        .section-title {
            color: var(--primary-red);
            font-size: 20px;
            font-weight: 800;
            margin-bottom: 24px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #f1f5f9;
            padding-bottom: 12px;
        }

        .edit-link {
            font-size: 11px;
            background: #fef2f2;
            color: var(--primary-red);
            padding: 6px 14px;
            border-radius: 100px;
            text-decoration: none;
            font-weight: 700;
            border: 1px solid #fee2e2;
        }

        /* Grid Premium */
        .rekap-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }

        .rekap-item-full { grid-column: span 2; }

        .rekap-item-premium {
            background: #ffffff;
            padding: 12px 16px;
            border-radius: 16px;
            border: 1px solid #f1f5f9;
        }

        .rekap-label {
            font-size: 9px;
            color: var(--soft-slate);
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .rekap-value {
            font-size: 13px;
            font-weight: 700;
            color: var(--dark-slate);
            word-break: break-word;
        }

        /* List Items (Pendidikan/Jabatan) */
        .data-box-premium {
            background: white;
            padding: 16px;
            border-radius: 18px;
            margin-bottom: 12px;
            border-left: 5px solid var(--primary-red);
            box-shadow: 0 4px 12px rgba(0,0,0,0.03);
        }

        /* Logo Watermark Background */
        .rekap-card::after {
            content: "";
            position: absolute;
            top: 20px;
            right: 20px;
            width: 80px;
            height: 80px;
            background: url('https://i.ibb.co.com/N2K0XRMW/logo-pdi.png') no-repeat;
            background-size: contain;
            opacity: 0.03;
            pointer-events: none;
        }

        /* Final Buttons */
        .btn-final {
            background: linear-gradient(135deg, #D71920 0%, #991b1b 100%);
            color: white;
            width: 100%;
            padding: 18px;
            border-radius: 20px;
            border: none;
            font-weight: 800;
            font-size: 16px;
            box-shadow: 0 10px 20px rgba(215, 25, 32, 0.3);
            cursor: pointer;
            transition: 0.3s;
        }

        .btn-final:active { transform: scale(0.98); }

        .nav-indicator {
            text-align: center;
            font-size: 12px;
            color: var(--soft-slate);
            margin: 10px 0;
            font-weight: 600;
        }
    </style>
</head>
<body>

<div class="container" style="padding-top: 20px;">
    <div class="header-form" style="text-align: center; margin-bottom: 10px;">
        <img src="https://i.ibb.co.com/N2K0XRMW/logo-pdi.png" alt="Logo" style="width: 50px; margin-bottom: 10px;">
        <h2 style="font-weight: 800; letter-spacing: -0.5px;">Final Review</h2>
        <p style="color: var(--soft-slate); font-size: 13px;">Geser kartu untuk cek akurasi data</p>
    </div>

    <div class="slider-wrapper" id="rekapSlider">
        <div class="rekap-card">
            <div class="section-title">
                <span>Profil Kader</span>
                <a href="step1.html" class="edit-link">EDIT</a>
            </div>
            <div id="fotoPreviewRekap" style="text-align: center; margin-bottom: 20px;"></div>
            <div id="rekapPribadi" class="rekap-grid"></div>
        </div>

        <div class="rekap-card">
            <div class="section-title">
                <span>Pendidikan</span>
                <a href="step2.html" class="edit-link">EDIT</a>
            </div>
            <div id="rekapFormal"></div>
        </div>

        <div class="rekap-card">
            <div class="section-title">
                <span>Kaderisasi</span>
                <a href="step3.html" class="edit-link">EDIT</a>
            </div>
            <div id="rekapKader"></div>
        </div>

        <div class="rekap-card">
            <div class="section-title">
                <span>Jabatan & Kerja</span>
                <a href="step4.html" class="edit-link">EDIT</a>
            </div>
            <div id="rekapJabatanPartai"></div>
            <div id="rekapPekerjaan" style="margin-top: 20px;"></div>
        </div>

        <div class="rekap-card">
            <div class="section-title">
                <span>Skill & Medsos</span>
                <a href="step6.html" class="edit-link">EDIT</a>
            </div>
            <div id="rekapOrganisasi"></div>
            <div id="rekapLainnya"></div>
        </div>
    </div>

    <div class="nav-indicator">
        <span id="cardCounter">Kartu 1 dari 5</span>
    </div>

    <div style="padding: 0 20px 40px;">
        <button onclick="submitSeluruhData()" class="btn-final">KIRIM DATA SEKARANG</button>
        <button onclick="window.history.back()" style="width:100%; background:none; border:none; color:var(--soft-slate); margin-top:15px; font-weight:700; font-size:13px;">Kembali ke sebelumnya</button>
    </div>
</div>

<script src="script.js"></script>
<script>
    window.addEventListener('load', () => {
    loadRekapitulasi();
    initMouseDrag(); // Aktifkan fitur tarik mouse sesuai permintaan
    
    const slider = document.getElementById('rekapSlider');
    slider.addEventListener('scroll', () => {
        const index = Math.round(slider.scrollLeft / slider.offsetWidth) + 1;
        const total = document.querySelectorAll('.rekap-card').length;
        document.getElementById('cardCounter').innerText = `Kartu ${index} dari ${total}`;
    });
});

// --- FITUR MOUSE DRAG (GESER TANPA SCROLLBAR) ---
function initMouseDrag() {
    const slider = document.getElementById('rekapSlider');
    let isDown = false;
    let startX;
    let scrollLeft;

    slider.addEventListener('mousedown', (e) => {
        isDown = true;
        slider.style.cursor = 'grabbing';
        startX = e.pageX - slider.offsetLeft;
        scrollLeft = slider.scrollLeft;
    });
    slider.addEventListener('mouseleave', () => {
        isDown = false;
        slider.style.cursor = 'grab';
    });
    slider.addEventListener('mouseup', () => {
        isDown = false;
        slider.style.cursor = 'grab';
    });
    slider.addEventListener('mousemove', (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.pageX - slider.offsetLeft;
        const walk = (x - startX) * 2; 
        slider.scrollLeft = scrollLeft - walk;
    });
    slider.style.cursor = 'grab';
}

// --- LOAD DATA FULL TANPA DIKURANGI ---
function loadRekapitulasi() {
    const data = JSON.parse(localStorage.getItem('kaderData')) || {};
    
    // 1. Foto
    if (data.foto) {
        document.getElementById('fotoPreviewRekap').innerHTML = `
            <div style="position:relative; display:inline-block;">
                <img src="${data.foto}" style="width:120px; height:120px; border-radius:30px; object-fit:cover; border:5px solid white; box-shadow:0 15px 30px rgba(0,0,0,0.1);">
            </div>`;
    }

    // 2. Data Pribadi (Semua Field Step 1)
    const fields = [
        {l: 'Nama Lengkap', v: data.nama_lengkap, f: true},
        {l: 'NIK', v: data.nik},
        {l: 'No. KTA', v: data.no_kta},
        {l: 'Tempat Lahir', v: data.tempat_lahir},
        {l: 'Tanggal Lahir', v: data.tanggal_lahir},
        {l: 'Jenis Kelamin', v: data.jenis_kelamin},
        {l: 'Agama', v: data.agama},
        {l: 'Status Kawin', v: data.status_perkawinan},
        {l: 'WhatsApp', v: data.kontak},
        {l: 'Email', v: data.email, f: true},
        {l: 'Alamat KTP', v: data.alamat, f: true},
        {l: 'RT/RW', v: `${data.rt} / ${data.rw}`},
        {l: 'Desa/Kel', v: data.kelurahan},
        {l: 'Kecamatan', v: data.kecamatan},
        {l: 'Kab/Kota', v: data.kab_kota, f: true}
    ];
    document.getElementById('rekapPribadi').innerHTML = fields.map(item => `
        <div class="rekap-item-premium ${item.f ? 'rekap-item-full' : ''}">
            <div class="rekap-label">${item.l}</div>
            <div class="rekap-value">${item.v || '-'}</div>
        </div>
    `).join('');

    // 3. Pendidikan Formal (Step 2)
    document.getElementById('rekapFormal').innerHTML = (data.riwayat_pendidikan || []).map(p => `
        <div class="data-box-premium">
            <div class="rekap-label">${p.jenjang} - ${p.jurusan || ''}</div>
            <div class="rekap-value">${p.nama}</div>
            <div style="font-size:11px; color:var(--soft-slate); margin-top:4px;">
                Lulus: ${p.tahun} | Kota: ${p.kota || '-'} | Status: ${p.status || 'Lulus'}
            </div>
        </div>
    `).join('') || '<p>Data Kosong</p>';

    // 4. Kaderisasi (Step 3)
    document.getElementById('rekapKader').innerHTML = (data.riwayat_kader || []).map(k => `
        <div class="data-box-premium" style="border-left-color: #1e293b;">
            <div class="rekap-label">Kaderisasi ${k.jenis}</div>
            <div class="rekap-value">${k.penyelenggara}</div>
            <div style="font-size:11px; color:var(--soft-slate);">Tahun: ${k.tahun} | Lokasi: ${k.lokasi}</div>
        </div>
    `).join('') || '<p>Data Kosong</p>';

    // 5. Jabatan & Penugasan (Step 4)
    const jPartai = (data.riwayat_jabatan_partai || []).map(j => `
        <div class="data-box-premium">
            <div class="rekap-label">Struktur: ${j.tingkatan}</div>
            <div class="rekap-value">${j.jabatan} ${j.bidang ? '('+j.bidang+')' : ''}</div>
            <div style="font-size:11px; color:var(--soft-slate);">Periode: ${j.periode}</div>
        </div>
    `).join('');
    
    const jTugas = (data.riwayat_penugasan || []).map(t => `
        <div class="data-box-premium" style="border-left-color: #fbbf24;">
            <div class="rekap-label">Penugasan: ${t.jenis}</div>
            <div class="rekap-value">${t.jabatan} - ${t.lembaga}</div>
            <div style="font-size:11px; color:var(--soft-slate);">Wilayah: ${t.lokasi} | Periode: ${t.periode}</div>
        </div>
    `).join('');
    document.getElementById('rekapJabatanPartai').innerHTML = (jPartai + jTugas) || '<p>Data Kosong</p>';

    // 6. Pekerjaan (Step 5)
    document.getElementById('rekapPekerjaan').innerHTML = (data.riwayat_pekerjaan || []).map(p => `
        <div class="data-box-premium" style="border-left-color: #64748b;">
            <div class="rekap-label">Pekerjaan</div>
            <div class="rekap-value">${p.perusahaan}</div>
            <div style="font-size:11px; color:var(--soft-slate);">${p.jabatan} | Masa Kerja: ${p.masa_kerja}</div>
        </div>
    `).join('') || '<p>Data Kosong</p>';

    // 7. Organisasi Luar, Skill, Medsos (Step 6)
    const listOrg = (data.riwayat_organisasi || []).map(o => `
        <div style="margin-bottom:8px; border-bottom:1px solid #eee; padding-bottom:4px;">
            <div style="font-size:12px; font-weight:700;">${o.nama}</div>
            <div style="font-size:10px; color:var(--soft-slate);">${o.jabatan} (${o.periode})</div>
        </div>
    `).join('');
    
    document.getElementById('rekapOrganisasi').innerHTML = listOrg ? `
        <div class="data-box-premium" style="border-left-color: #0ea5e9;">
            <div class="rekap-label">Organisasi Luar</div>
            ${listOrg}
        </div>` : '';

    const ms = data.media_sosial || {};
    document.getElementById('rekapLainnya').innerHTML = `
        <div class="rekap-grid" style="margin-top:10px;">
            <div class="rekap-item-premium"><div class="rekap-label">Bahasa</div><div class="rekap-value">${data.kompetensi_bahasa || '-'}</div></div>
            <div class="rekap-item-premium"><div class="rekap-label">Komputer</div><div class="rekap-value">${data.kemampuan_komputer || '-'}</div></div>
            <div class="rekap-item-full rekap-item-premium">
                <div class="rekap-label">Media Sosial</div>
                <div style="font-size:12px; display:flex; gap:10px; flex-wrap:wrap;">
                    <span><b>FB:</b> ${ms.facebook || '-'}</span>
                    <span><b>IG:</b> ${ms.instagram || '-'}</span>
                    <span><b>TT:</b> ${ms.tiktok || '-'}</span>
                </div>
            </div>
        </div>`;
}

</script>
</body>
</html>
