<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Kader DIY</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .step { display: none; animation: fadeIn 0.3s; }
        .step.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        input, select, textarea { border-bottom: 2px solid #e2e8f0; width: 100%; padding: 8px 0; margin-bottom: 15px; outline: none; }
        input:focus { border-color: #b91c1c; }
        .btn-red { background: #b91c1c; color: white; font-weight: bold; width: 100%; padding: 15px; border-radius: 12px; text-transform: uppercase; }
        .card { background: white; border-radius: 20px; padding: 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="bg-slate-100 pb-10">
    <div class="bg-red-700 p-8 text-center text-white mb-[-40px]">
        <h1 class="font-black text-xl">FORM KADER PDI-P DIY</h1>
    </div>

    <div class="max-w-xl mx-auto px-4">
        <div class="card">
            <div id="s1" class="step active">
                <div class="text-center mb-5">
                    <div id="p-view" class="w-24 h-32 bg-slate-200 mx-auto rounded-lg mb-2 overflow-hidden flex items-center justify-center text-[10px] text-slate-500">FOTO</div>
                    <input type="file" id="f-in" accept="image/*" class="hidden" onchange="preview(this)">
                    <button onclick="document.getElementById('f-in').click()" class="text-xs font-bold text-red-700 uppercase">Pilih Foto Profil</button>
                </div>
                <input id="nama" placeholder="NAMA LENGKAP *" oninput="this.value=this.value.toUpperCase()">
                <input id="nik" placeholder="NIK (16 DIGIT) *" maxlength="16">
                <input id="kta" placeholder="NOMOR KTA">
                <div class="grid grid-cols-2 gap-2">
                    <input id="tm_l" placeholder="TEMPAT LAHIR">
                    <input id="tg_l" type="date">
                </div>
                <button onclick="go(2)" class="btn-red mt-4">Lanjut â†’</button>
            </div>

            <div id="s2" class="step">
                <input id="wa" placeholder="WHATSAPP *">
                <div class="grid grid-cols-2 gap-2"><input id="ig" placeholder="INSTAGRAM"><input id="fb" placeholder="FACEBOOK"></div>
                <textarea id="alm" placeholder="ALAMAT LENGKAP"></textarea>
                <div class="grid grid-cols-2 gap-2"><input id="rt" placeholder="RT"><input id="rw" placeholder="RW"></div>
                <input id="kec" placeholder="KECAMATAN">
                <select id="kab"><option value="">-- PILIH KAB/KOTA --</option><option>KOTA YOGYA</option><option>SLEMAN</option><option>BANTUL</option><option>KULON PROGO</option><option>GUNUNGKIDUL</option></select>
                <div class="flex gap-2"><button onclick="go(1)" class="w-1/3 text-xs">Kembali</button><button onclick="go(3)" class="btn-red">Lanjut</button></div>
            </div>

            <div id="s3" class="step">
                <h3 class="font-bold text-red-700 text-xs mb-2 uppercase italic">Pendidikan & Kaderisasi</h3>
                <div id="box-edu"><div class="item bg-slate-50 p-2 mb-2"><input class="val" placeholder="JENJANG: SEKOLAH"></div></div>
                <button onclick="add('box-edu')" class="text-[10px] text-blue-600 mb-4">+ TAMBAH SEKOLAH</button>

                <div id="box-kader"><div class="item bg-red-50 p-2 mb-2"><input class="val" placeholder="JENIS KADERISASI (THN)"></div></div>
                <button onclick="add('box-kader')" class="text-[10px] text-red-600 mb-4">+ TAMBAH KADERISASI</button>

                <h3 class="font-bold text-red-700 text-xs mb-2 mt-4 uppercase italic">Pekerjaan & Organisasi</h3>
                <div id="box-job"><div class="item bg-slate-50 p-2 mb-2"><input class="val" placeholder="PEKERJAAN: INSTANSI (THN)"></div></div>
                <button onclick="add('box-job')" class="text-[10px] text-blue-600 mb-4">+ TAMBAH PEKERJAAN</button>

                <div id="box-org"><div class="item bg-slate-50 p-2 mb-2"><input class="val" placeholder="ORGANISASI: JABATAN"></div></div>
                <button onclick="add('box-org')" class="text-[10px] text-blue-600 mb-4">+ TAMBAH ORGANISASI</button>

                <input id="jab-p" placeholder="JABATAN STRUKTURAL PARTAI">
                <input id="tgs-p" placeholder="PENUGASAN (LEGISLATIF/LAINNYA)">

                <div class="flex gap-2 mt-4"><button onclick="go(2)" class="w-1/3 text-xs">Kembali</button><button id="btn-s" onclick="kirim()" class="btn-red">SIMPAN DATA</button></div>
            </div>
        </div>
    </div>

    <script>
        const scriptURL = 'YOUR_APPS_SCRIPT_URL';
        let img64 = "";

        function go(n) { 
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.getElementById('s'+n).classList.add('active');
            window.scrollTo(0,0);
        }

        function add(id) {
            let el = document.getElementById(id);
            let clone = el.firstElementChild.cloneNode(true);
            clone.querySelector('input').value = "";
            el.appendChild(clone);
        }

        function preview(f) {
            let r = new FileReader();
            r.onload = (e) => { 
                img64 = e.target.result;
                document.getElementById('p-view').innerHTML = `<img src="${img64}" class="w-full h-full object-cover">`;
            };
            r.readAsDataURL(f.files[0]);
        }

        async function kirim() {
            const btn = document.getElementById('btn-s');
            btn.innerText = "SEDANG MENYIMPAN..."; btn.disabled = true;

            const getList = (cls) => Array.from(document.querySelectorAll(`#${cls} .val`)).map(i => i.value).filter(v => v).join(" | ");

            const p = {
                nama: document.getElementById('nama').value,
                nik: document.getElementById('nik').value,
                wa: document.getElementById('wa').value,
                kabkota: document.getElementById('kab').value,
                p_formal: getList('box-edu'),
                p_kader: getList('box-kader'),
                jabatan: document.getElementById('jab-p').value,
                tugas: `KERJA: ${getList('box-job')} || ORG: ${getList('box-org')} || TGS: ${document.getElementById('tgs-p').value}`,
                foto: img64
            };

            try {
                await fetch(scriptURL, { method: 'POST', body: JSON.stringify(p) });
                alert("MERDEKA! Data Tersimpan."); location.reload();
            } catch (e) { alert("GAGAL!"); btn.innerText = "SIMPAN ULANG"; btn.disabled = false; }
        }
    </script>
</body>
</html>
